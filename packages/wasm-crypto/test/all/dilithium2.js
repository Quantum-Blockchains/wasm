// Copyright 2019-2022 @polkadot/wasm-crypto authors & contributors
// SPDX-License-Identifier: Apache-2.0

/* global it */

import crypto from 'crypto';
import { assert, hexToU8a, stringToU8a, u8aToHex } from '@polkadot/util';

/**
 * @internal
 * @param {*} pair
 */
function extractKeys (pair) {
  return [pair, pair.slice(0, 2528), pair.slice(2528)];
}

// /**
//  * @internal
//  * @param {*} wasm
//  */
// function randomPair (wasm) {
//   const seed = crypto.randomBytes(32);
//   return extractKeys(wasm.dilithium2KeypairFromSeed(seed));
// }

/**
 * @param {*} wasm
 */
export function dilithium2PairFromSeed (wasm) {
  const seed = [
            0x7C, 0x99, 0x35, 0xA0, 0xB0, 0x76, 0x94, 0xAA, 0x0C, 0x6D, 0x10, 0xE4, 0xDB, 0x6B,
            0x1A, 0xDD, 0x2F, 0xD8, 0x1A, 0x25, 0xCC, 0xB1, 0x48, 0x03, 0x2D, 0xCD, 0x73, 0x99,
            0x36, 0x73, 0x7F, 0x2D
        ];
  const [pair, sk, pk] = extractKeys(wasm.dilithium2KeypairFromSeed(seed));

  console.log('\tSEC', u8aToHex(sk));
  console.log('\tPUB', u8aToHex(pk));

  assert(u8aToHex(pair) === '0x1c0ee1111b08003f28e65e8b3bdeb037cf8f221dfcdaf5950edb38d506d85bef394d1695059dff40ae256c5d5edabfb69f5f40f37a588f50532ca408a8168ab187d0ad11522110931494bf2caeae36979711bc585b32f08c78496f379d604d53c0a6711a966c11312ad9a821d8086542a600a4b42c1940720242628106210a43852331709308108b188c022492c1b28412c4218b042181c8610248059c9201c0348819326c582046891868a2c28d82346a1c094200a28ce3a6491c112cc24812e0902191985062c084622451ca062c64240e1bb3312496854b4606db2668c38268441046c9b6211404811445502442084422710b92459aa0811a91709c241003957004c504c82692d29200c0b260c0a26809190aa2300e188969e0008dd84862da14712018051907440412409b1240118010d142819928508b1091022464a0206d1246211c838c1b4769010690cc062481846920982c24120521b15041360298446ed1a63111056ad3a840caa84c62b00003134a53344614194004c54ce306695ab08961168ecb10808b168ed990640b94602483851ab30454262251b8251c424a0b814842c4445a102023808409b7254cc64814854d19380e601651d8326a0a918908c170e0964d18468c01328d91c4054a0061230868a2104210a8611306218a248e620689c9b24508278451200d980466dc42054424852426282221612016090ba62c0a1144e0928158480d422210a006098b246e81288cc0248090308d8436404ca68450042494b68da2926d18b344a00085e3b805140504a4c290842281c3262d0b2066cc903198382810166cc13445c0102224c688034632d840901c20680415289a188144988d9c206e9c302cc1b820614221080310a0c28c58128553204c0330814ca48d44c08d51404c1ca72c440865a03840da20808106858c260de2a88c9c4411594228c42604441426a1426408c0851101869b483199b20c80464459a88c0042089882900ab54562244812960544124600c88813a061e1284d0ab9914b962099b84400314e98128500b60183a00d14150e1881101901224a06681a498de1a28411c63121262591a06d030524a1b6089444724334125bb42041b650d0888d0b074d1c94644c208e8b8808e0300944200549864d03134e19c9840937611a43684a80900204311c1742184080c8308ee1a241c33404a3282251247188d6fef46712ca182872ab2919678aff9d94e743e063a39e0c35caf72a7f2eda28e65858520d5d8467de747cf340653b52c268f55413f5addc7d49011ec33edd537423a84288869337aea0781a124269071451722db3bb8f2ce5b1552f83d2af07f25613918a9f4e6f1257603888e589308ca5f95f07143d23baae17520b36b6e0e94faf6845eb2131aec383e63bc8644ee5f1accba82f9211e57afcbf509c1131a37466bc91b357dcbbbc14ccc319c4cc6ac75fcdc82c6596d07770c8277ad370b192a0b4e05f812e0e265d2912aa29f03fc9f72dfa69c9b1291a3fc583642b235f6991a954788347f60a0328c48ecee51ba02dff323abd911667cb14549b618f1c5d250cac9e35e071601992fbec0bae6f74213081404744d12f2a0e04bdb265e0924cada40d1fa1f38aca4606bfd4575712b8260a456fddeeefe7ca259bcda97b9b939a5fd2889c9b49fb7d4e3553dea61b3339bd0e6b16bf3bb227103bf9202e72dc502e28f7ce1559a4631f372520324e4eba07545f78bf4d94b0e5b8bf51b8f176533d5cfea5232f283a47605fa65ddb17c891c251011c4e98eeb6eb00cb65ba31c8f025c87a9fe02dbc10c5d83a065eba5d7b2a19d5a1cb2c160ae166e867f2af8c7d49d63fb83a614957fc0a3b5a5c74990e9a2b02120c7e6de37e155fb472f50f0a45e47cf5f9d7a4c82982c9dc86ae877c3fd1885943e439fb003c7a9a42f71b4ff6f0a28b140cbdba6e71b13ac31b23de9eab7837e15a69f833eb7b56a71d8bc2caf1f2a31c345bd5f46ee013a7c689372337191daa800c0ac6c46c9ff688b1a01347f257c474aa3d97c1d63a8c00e0a37b681673f57c1c9c8fccd46f174c74a29d84ceb71f7e6b2f8cd2b089ed43f7c96dae81a223418c20b16f1df3d1a978ae28f6df35ec559d04d20ec74b224aea31a289b015b069e9cbbbf7cf6de94cfb2a96e4ae3462c96003cdda87db561af2ce3c0ba1d90413fdce3ccf4390c02c1cb9f654f4820ec33015457d4a629fbf39419cab7642d6885e103fce0d4206cce7c12c6fc44fa33ad0864c3371a7cbe820e3b371b656a38f2e7ff18fe4a50c8ab3f85d783fb57835ced8490b84ee0d99af0d64c483ceb6366ff54f8ac8a40db1afa573a4fb326c74f0236ecef3da7120665cce05dd654b5071723a8348e7cd7793513819b61cb64e1328e8b22e7664bd6b41b5710d19ea8809d4450850e907dfc4d0b75f588cece962e9e0937ce1402446a4d2891a46e6617fb29d4fcd712606f7819eca60f7e0d5b19e7ffb57c73c16ffeeb90038410cb9fcbb5e9d51eb3eb6297e9ff6ab7088fe2d9b237bc24cf7f8290118a5e0e00a0b903fb6375c848176cd0a8c8875cc59199cda11a87a78f65cc404330b087571fd0633e27129fdab5a8a1f793e52412b0083fd5c74db3cf60c2543ce7c91b2800e40203f8d99fe5fde5b108e7edc80ebb9bb34986ec5c5a8f580e75752907ff0f294c866c2cf1f362e840b6881bd43219201781c63b0039a95bcfb4a0fece569df00523ce9c084b022b3b022242e28419796acf0a0c995f948dbfffd30d77ed105a3c9943c406b305bc81a6a248a291548f2a67f438d966a57d53f4b7be15354e581be16f7ad64d164e85787df5849c810afc28d06482f441b5fde3db2ed36dd25aa6664d4d43ffa32eda25689c9f4a5d514fc66231c5401520922524438ef1dc78d693c9718debbd243312674c899f18910e389c8ebe505824bcc42cd4a9ace193768220219011f3b1f335427bff9e8bded5c08711a09c2b71cb964c56a8393bfd2b56e9b6b2f513e682587dc1b8ed196066326871025628036700063176d345de384e182d6c417a32ab11095ef59bb4d171b9cf81d17ac42664ded933ccb722c69857ffc53c8e7f2474b0cb2dff2ddc8a5c601c84a701981199bccf74112a6ec062c4feb601a028af01032adb6bd15d4c2b9550aa850ad62ccc3a3665d5212b12e0fd5c5326a1e5eb1f10d557d94605e8e3f356e08ff7fd884ed3c4205463594c9af2f39e4b1274695234b54eeced93f460edf1a13c2cb4b17d322f6f79fe16f0357c1c4739863e796791f8647fabf730ab00e0da509706d94571740f61f7baf366d2774c9b5b8c61dd6be9819a6028b264bb2e4aea54b56d4ecab5b528ce0c0c0ccdb73023352cb00445bab6f7467b4644d4361c464fac6b5b137d32391021b475fcb5f31774fd8ecabdf65475f25574c65559cb331f41c0f498b74dd941c344c50d8e64f9578714a32561faaceaf78148e6da4b566826925714b17108afdd546385a3cd454d5caa16960916282a47c4315ce236bd9e3255c604ebdc39772db5ce0b2361c0ee1111b08003f28e65e8b3bdeb037cf8f221dfcdaf5950edb38d506d85bef6177e3de0d4f1ef5847735947b56d08e841db2444fa2b729adeb1417ca7adf42a1490c5a097f002760c1fc419be8325aad0197c52ced80d3df18e7774265b289912ceca1be3a90d8a4fde65c84c610864e47deecae3eea4430b9909559408d11a6abdb7db9336df7f96eab4864a6579791265fa56c348cb7d2ddc90e133a95c3f6b13601429f5408bd999aa479c1018159550ec55a113c493be648f4e036dd4f8c809e036b4fbb918c2c484ad8e1747ae05585ab433fdf461af03c25a773700721aa05f7379fe7f5ed96175d4021076e7f52b60308eff5d42ba6e093b3d0815eb3496646e49230a9b35c8d41900c2bb8d3b446a23127f7e096d85a1c794ad4c89277904fc6bfec57b1cdd80df9955030fdca741afbdac827b13ccd5403588af4644003c2265dfa4d419dbccd2064892386518be9d51c16498275ebecf5cdc7a820f2c29314ac4a6f08b2252ad3cfb199aa42fe0b4fb571975c1020d949e194ee1ead937bfb550bb3ba8e357a029c29f077554602e1ca2f2289cb9169941c3aafdb8e58c7f2ac77291fb4147c65f6b031d3eba42f2acfd9448a5bc22b476e07ccceda2306c554ec9b7ab655f1d7318c2b7e67d5f69bedf56000fda98986b5ab1b3a22d8dfd6681697b23a55c96e8710f3f98c044fb15f606313ee56c0f1f5ca0f512e08484fcb358e6e528ffa89f8a866ccff3c0c5813147ec59af0470c4aad0141d34f101da2e5e1bd52d0d4c9b13b3e3d87d1586105796754e7978ca1c68a7d85df112b7ab921b359a9f03cbd27a7eac87a9a80b0b26b4c9657ed85ad7fa2616ab345eb8226f69fc0f48183ff574bcd767b5676413adb12ea2150a0e97683ee54243c25b7ea8a718606f86993d8d0dace834ed341eeb724fe3d5ff0bc8b8a7b8104ba269d34133a4cf8300a2d688496b59b6fcbc61ae96062ea1d8e5b410c5671f424417ed693329cd983001ffcd10023d598859fb7ad5fd263547117100690c6ce7438956e6cc57f1b5de53bb0dc72ce9b6deaa85789599a70f0051f1a0e25e86d888b00df36bdbc93ef7217c45ace11c0790d70e9953e5b417ba2fd9a4caf82f1fce6f45f53e215b8355ef61d891df1c794231c162dd24164b534a9d48467cdc323624c2f95d4402ff9d66ab1191a8124144afa35d4e31dc86caa797c31f68b85854cd959c4fac5ec53b3b56d374b888a9e979a6576b6345ec8522c9606990281bf3ef7c5945d10fd21a2a1d2e5404c5cf21220641391b98bcf825398305b56e58b611fe5253203e3df0d22466a73b3f0fbe43b9a62928091898b8a0e5b269db586b0e4ddef50d682a12d2c1be824149aa254c6381bb412d77c3f9aa902b688c81715a59c839558556d35ed4fc83b4ab18181f40f73dcd76860d8d8bf94520237c2ac0e463ba09e3c9782380dc07fe4fcba340cc2003439fd2314610638070d6c9eea0a70bae83b5d5d3c5d3fde26dd01606c8c520158e7e5104020f248ceaa666457c10aebf068f8a3bd5ce7b52c6af0abd5944af1ad4752c9113976083c03b6c34e1d47ed69644cad782c2f7d05f8a148961d965fa2e1723a8ddebc22a90cd783dd1f4db38fb9ae5a6714b3d946781643d317b7dd79381cf789a9588bb3e193b92a0b60d6b07d047f6984b0609ec57543c394ca8d5e5bcc2a731a79618bd1e2e0da8704af98f20f5f8f5452ddf646b95b341dd7f0d2cc1fa15bd9895cd5b65aa1cb94b5e2e788fda9825b656639193d98328154a4f2c35495a38b6ea0d2ffaaa35df92c203c7f31cbbca7bd03c3c2302190cecd161fd49237e4f839e3f3', 'ERROR: pairFromSeed() does not match');
  assert(u8aToHex(pk) === "0x1c0ee1111b08003f28e65e8b3bdeb037cf8f221dfcdaf5950edb38d506d85bef6177e3de0d4f1ef5847735947b56d08e841db2444fa2b729adeb1417ca7adf42a1490c5a097f002760c1fc419be8325aad0197c52ced80d3df18e7774265b289912ceca1be3a90d8a4fde65c84c610864e47deecae3eea4430b9909559408d11a6abdb7db9336df7f96eab4864a6579791265fa56c348cb7d2ddc90e133a95c3f6b13601429f5408bd999aa479c1018159550ec55a113c493be648f4e036dd4f8c809e036b4fbb918c2c484ad8e1747ae05585ab433fdf461af03c25a773700721aa05f7379fe7f5ed96175d4021076e7f52b60308eff5d42ba6e093b3d0815eb3496646e49230a9b35c8d41900c2bb8d3b446a23127f7e096d85a1c794ad4c89277904fc6bfec57b1cdd80df9955030fdca741afbdac827b13ccd5403588af4644003c2265dfa4d419dbccd2064892386518be9d51c16498275ebecf5cdc7a820f2c29314ac4a6f08b2252ad3cfb199aa42fe0b4fb571975c1020d949e194ee1ead937bfb550bb3ba8e357a029c29f077554602e1ca2f2289cb9169941c3aafdb8e58c7f2ac77291fb4147c65f6b031d3eba42f2acfd9448a5bc22b476e07ccceda2306c554ec9b7ab655f1d7318c2b7e67d5f69bedf56000fda98986b5ab1b3a22d8dfd6681697b23a55c96e8710f3f98c044fb15f606313ee56c0f1f5ca0f512e08484fcb358e6e528ffa89f8a866ccff3c0c5813147ec59af0470c4aad0141d34f101da2e5e1bd52d0d4c9b13b3e3d87d1586105796754e7978ca1c68a7d85df112b7ab921b359a9f03cbd27a7eac87a9a80b0b26b4c9657ed85ad7fa2616ab345eb8226f69fc0f48183ff574bcd767b5676413adb12ea2150a0e97683ee54243c25b7ea8a718606f86993d8d0dace834ed341eeb724fe3d5ff0bc8b8a7b8104ba269d34133a4cf8300a2d688496b59b6fcbc61ae96062ea1d8e5b410c5671f424417ed693329cd983001ffcd10023d598859fb7ad5fd263547117100690c6ce7438956e6cc57f1b5de53bb0dc72ce9b6deaa85789599a70f0051f1a0e25e86d888b00df36bdbc93ef7217c45ace11c0790d70e9953e5b417ba2fd9a4caf82f1fce6f45f53e215b8355ef61d891df1c794231c162dd24164b534a9d48467cdc323624c2f95d4402ff9d66ab1191a8124144afa35d4e31dc86caa797c31f68b85854cd959c4fac5ec53b3b56d374b888a9e979a6576b6345ec8522c9606990281bf3ef7c5945d10fd21a2a1d2e5404c5cf21220641391b98bcf825398305b56e58b611fe5253203e3df0d22466a73b3f0fbe43b9a62928091898b8a0e5b269db586b0e4ddef50d682a12d2c1be824149aa254c6381bb412d77c3f9aa902b688c81715a59c839558556d35ed4fc83b4ab18181f40f73dcd76860d8d8bf94520237c2ac0e463ba09e3c9782380dc07fe4fcba340cc2003439fd2314610638070d6c9eea0a70bae83b5d5d3c5d3fde26dd01606c8c520158e7e5104020f248ceaa666457c10aebf068f8a3bd5ce7b52c6af0abd5944af1ad4752c9113976083c03b6c34e1d47ed69644cad782c2f7d05f8a148961d965fa2e1723a8ddebc22a90cd783dd1f4db38fb9ae5a6714b3d946781643d317b7dd79381cf789a9588bb3e193b92a0b60d6b07d047f6984b0609ec57543c394ca8d5e5bcc2a731a79618bd1e2e0da8704af98f20f5f8f5452ddf646b95b341dd7f0d2cc1fa15bd9895cd5b65aa1cb94b5e2e788fda9825b656639193d98328154a4f2c35495a38b6ea0d2ffaaa35df92c203c7f31cbbca7bd03c3c2302190cecd161fd49237e4f839e3f3", 'ERROR: Public key');
}

/**
 * @param {*} wasm
 */
export function dilithium2SignAndVerify (wasm) {
  const seed = crypto.randomBytes(32);
  const [, , pk] = extractKeys(wasm.dilithium2KeypairFromSeed(seed));

  const signature = wasm.dilithium2Sign(pk, seed, stringToU8a('this is a message'));
  const isValid = wasm.dilithium2Verify(signature, stringToU8a('this is a message'), pk);

  console.log('\tSIG', u8aToHex(signature));
  console.log('\tPUB', u8aToHex(pk))
  console.log('\tRES', isValid);

  assert(isValid, 'ERROR: Unable to verify signature');
}

/**
 * @param {*} wasm
 */
export function dilithium2VerifyExisting (wasm) {
  const isValid = wasm.dilithium2Verify(hexToU8a('0xf89fc402059d859bf2750ff61d5e7236f51a091221fc416dd908180816eb2935de7c36b08e759cfcfa88821137fe7fd6d1850779099d97bede307a6daac060260ea0d8087950c7c989734681d0316a768f48fd5b2c4f9fe6e80d056e70b0bcea185f576c1c1f476a168b19db34c8358fec172e32804318e620d4d92f75e9897356f3ae31435c71123fca6ce5145cf9f2ea2972a4b3c3613a5d88e8919b441673ce2a0a61f1749d38e0cb95792938b9882eaf4674c18aef745568a19baac58365f86bff4e3c7a80dd1db30dd8c4ceab5e24ebc312b09df55b485ba0c28682fa864ba1838b2d8929cccec5920fa7785aa38d003b358c70813410fd53b619ddd2e52a1098737221d9c4af60902180764912a01093fd10469f158093cab77c835ee03656c925940fcdb6a1b4454ca66f7fff6f96fbf634a767f60c85a1dfb37f4c0c4536a2fe6ecafe7911a8a9cd865cefcdfb0d68d8a8c5e4be02052e9863da6157546ecc842e16d0c517b0479df84899e27c559d184eff103a1bdaba41531a14f901679796c5015afdaf0075cdc967183e07395dc853e5d42e5c96980b4e539e710060d06b837536326adf1cd0f0adbd0337a494717af68e8e935b736b6808e5d728c0f250b08a1fe6f6e06bf7ef97cbc903a53b61eaa465819491f09e50c42f21388482b4fe43230c9dbb1c3f60adf2e65b1f79889aa2fcb7b9532eadfa661dc53e471d113a70ddd394d937b7f6b9fc6cd355a73db1b13ade8eb6a4f198fe70581120f73b0c8c833d80efe66c28e1b87e7adc66db53a32cd1b3174d052f7666fe0126a0072f40c1b36e5dc4f3f53fe99ffedac8218bf275bbdff376357df694fd1c6a11e52976460b25b7a5d7daa705645f9a404b9c5dbdef5a147016871663cbfa52cbe5eefe2265cabc5010d9502efda66ec006fe701052f2890bf63a67b8ad068961625f02b76eb33cfd3dc63ecd79571fce0c9aca64e05975c01137bbfe0edf98ce58b553be3a5ad5d56cc996507c49c0ec4032b1194a6ddb27456e3678f2bbd7fa6370f92a6366937299edb4e0edee6418ff3569907e254bae84420a22c1f4def9f64ee249fbcb87ff22b783a1bcb10bdfeeaa5aa540c3c468f8521f3bd452912d33dde8a0011293498f5f3606604d0bc25f95cf830bbc382e81de8476f28540793ae4a6d635f7683f05846e74dedfd3bc16858fb8cc91c12063fa3c7699b15ae6bc283a55b5d448b4a31c605523f5eee53fa8c16446813b4259dc3a15ef55d82bebdc801a8dfac43926178f8882625749f5be973b9e8857b96e600c0e6cd8b5a0177558dfc57b6f7e776e97ead5b1614467d8e6679cbf64d387a4386a84f4acfa0249417bedc824688cca9517dbf802ca1cebd2a822f89517c5750ca8ad7fdbcd3b46cce42834f13dbdffe3db3519d2d0c12fcf290e7bc2f05b1dc50736b604115717b283757d6694995b953aa6f9e46667427120b24bafa97ce62695bdf31aa4a9660dd9bb509895fbe940ca6c73bd9f56b23fa653a306a8890bd3a3720eb0c10ed76fc772ea15a42321b8c5ffaac71c9ff907a67a87cc4231c6edfcaba8975272bbad2caebde9c73780d26661ef37f0d480210c8af3a28d708cfdc0597a91d03d31da1095676f254dc5e2c37634e8009d969f9c9241044f44b9f92cd4443338686b28fa93b689f8a87b652c672162e98a9c4bc90f909cfcaa5af20e255e22fe74e8abc5058935fa87d59cd397cecd6765caf9911207d32720ab9ed910df0b6667462ddd69cc135d4d406c49294c3180be892586c3297ef7df9964509e0445b3244f95c407e4b5545f6bf72b6e3ad87aae03945405358cf56cc25700f25ca9ba16f33f1035eab98acb93d7fa0861e31d3630c2548568c771b9829c1e0992079f853d1608f38e17cd6a13e4eb934ef81a111325741ce758d0ff6d98239a1014da7e13e598a3df5d6db48d0653518668e6765c560872a501b77b1adb1e6e9c522a8f04037d21e9d14d4b23c79d28397530411d8a39e086d52345bd1eaaea128339869418588d179d0e7a2d1ab51c8387125101f92d719523a0c40b66c6e2ff874af5dca3891236180077ee2513fdee58a5e814d9fabdba6da1193f9e5a4744856dd2aa4114ab5eb0d481dfd49a5f2e6bb7d49906ac9bcd440bd2f297eead8f05f3e5b628c9b28dd5b00d674fc5391c9ed5eea4ce51019702324f28321e38470f501cf27b234ea8c936b003639a057305af299b82c34ffe628efc782b5fe17137f17cf3afe7d21f679ca1f63128728deff9c79b8890ab4b6278fd600263a0fe59a752d073913c58bd34f52984637f0e128dda54fd7fdd4bb3d9f0cd20bb4184f12d6190c8a6fb05b5355fb924579d6ae8ee236c6ec0ef573736950c6bfedc447d423f618974b73ee280e6beb4b22a8d1cec6f4fd5dbbb4c77263b07684452ca0585bbf98d4ef2eb162dd480db48175899db43463244c12acb9abf4f77c104e4b3e008a492f95bf4ca0e53da6eea7be1f24a8d5287bc17412bda8142311e7070b70a2bf4c319e04c3e18f5e758fec0719646415afe786137110b1c220b8826b362813ce52281185a45f9bb697c346c8b0d8c5c7b910250843dcea8bd3096f553394822bfbf7d07a1e0a00716bca67506df1c8f39a0c6394a30832147bebf4d6e0061ab640ac6eba49bba7ea5895562b0b6b0921fae4366f5a3d96e7b74d07747cbbfd0a0b0e94f61c1bf1b923956dc4764621accaa94011e70a8a132ebf9eee5332138fe837416b9d1597c644bde667e4793f5907d1e5f8ef9879f7cc015f3e6622ad4e20c0d1dfa68c6bafd1102ebf42be2e2587374006fe3bcdffe2eb0fea8aef49558d6f6f74b43d10484baa101b63dd571bd6fac7d358bc2ae166eaf93d976d175d259e7ecedbd0dc095a7bd6631b3b3bff31a47da31dadbb317a674b81bc0de8382ab3c23ddbbfae2aba6531a108a914ae32a65ab6fa4db585bac8cf19d6e6aed6a3cb7c7475caf667387667c27a8c2f0eef32d68b8314b55a38b1f77294c22fdd5344ed8fb250fe702aa8aaee22493064ecb430e0db4a35c50d97877f0f6c068ab1ae87ce532cdc5f387070fc461e19fe150bba973715343a2b1b717b6d851893352b7eb8215ca32307b1141aceb54a3123ed21ba4248fabde4a75da797cebd747af250bc716b17055d42d39d2363434156667da268abe0ce92e27adbb0b9d54cf4047ca928b6974e8ee0f6f5184b730ca4400a64764c6356641b75f6389f4037dc1bab03a840a57c151a5ec232f04b23c5200bb2ba3a5b72437c4c91e43646e78889eaaafd6e3f2fc000f131a1c26282a2d36546377c4f90005347174799babbdcfddf1f405070b323547535a7386898c909bd3d4d9dbdddee6eef5000000000000000000000000000000000d1c2940'), stringToU8a('this is a message'), hexToU8a('0xde4128d2b422c80434a0d4a3ca48580d4d433ab24134c843834a8ed432610aac36affda4b96d6f063e1de27afe29be3c01369ce7dd02826d7c429d6437b0d811dcad224de4379760d01e5f59eec7a625e51defd309aa82fd2db9633e31d193110e0ef3f333612b9bf1f736fd4705507e337630cd885a8fd9521d95b32d9be7f6c47ef85ba6de6e6a7471f2d7d6e57749b14f74d2ab9ba465e57874e10d5396e3b0b957430ccc86f83a51d0e44df5ad7c22f0c9ad911bfd28ff9e0f83bc4ba3f0eed3a2d5428a4463de5dfcb3daf268a126bcd752dff13ead5afb88199a8fa8c5c56e338f4faa008d834f247964c7a48e694deab2535a18eb634c013d2771d968e70f97717a6510e3eb0866b048f37341e22bf85cd48828ca38519a13a5b09139b605ad56bb9139a54a5dc08679b200276fde586f99cdffd5c9410073c748ce92c1a0dc4a11099c8b76b6019e9bbcb18ea10f96b9dba0c34db4c4e955ec7088b423aecd9fe7a8db253a54e1a720512a98f5419a71546dcaa33023f0ec8297ce41acda16849582d40d7f181e224f422906a0a0194e76fe4efb450351a0cba610e2d977d80bbd686dfe87627793c92b1fba927eb9b73c5a1ded3a6384099ad3a720e3fd4721e30b29fbb26daeee283cbd7681ccfc4feae639b773e0ac88881a44ed08d6c8c19a85a9eab82ae4f65315c95aba59138cd9aeb41e449b110e28a005f743d9e3824de8d695bc436b2171c8f8e0fd9746ffb26c4d1f6189578bf0793cc3bb0e68bc29702db9114cf01abd237038e8d08eaa55328f2b7f8401dd225f6f3410224acffddb5a164c86a24e67733d2d46e797e5fd75836c31e400222c0c146a43f21feabc4efd78a7bb8cca01b7f84259aa9ba1fba8aa578195e72d0cfb0fa9873991b2d38875ece27b8c5c916adf9c522625c6fbaaa4da4cee405610d47be60d00b3e1cc78ef6c9c0022ef7af26d2fef6be4edc94210a6bdec89b2bd973a6de6b1c5898dcf3371ac15152cfd3f226d1f9fb7f64c22035f0b2cfe17b94aebf9964b31f7497e5c0552f16074489697ed43fd444a714db7505a7003fe6a57a2f8bafe3eb1a8da7e3649d02159317262d96e82288190cd1da1e043d3cd8fe5317eddebd69784749843e89c28c1a977c5afbb2c84f481e06a3a1a5b929b246b20e365d2eccce1cd7f1224141ceb6a28cfeddd458d9fac4deaf0b4799bbf199001f29f9e1b31da07f801d6c2a297ee1c47b647fe614a89bbddf50c278f76682bc05adbe8ea9d7e75fc864b8a0320c1ad944708ff5c8108e0bbf8a29034dca286fce0c7152da9fb07dbaf4a9cfb9ea50fb57c707e31cd5b54952a7ef79d4bdf86b728374ab642c2c526c52bff75abc34d0307d9d3889420efd9f322ee477bbb47f26faef4556c94b8b7e8836c2d298f59109735164a5edffb2796e8f3e9830b316241f3d2c5af93b41ea87a9189d9c6681cfcbed1fb83e47c31ed421ba9070c68b72a753b2344fd2e39f014a3cb99a1f077f992b3eb7945df3ebee0194a18e41381632a48d31af8fc5ce3f3ed45b149e610333ed59f5a012a0bf4e12be25b0a6e876e44f2b4d4721a7cd136dd72c8a7e679b8c31b084000001b012e26f78a8824c99aaf8ea094706207ea399c14a6fa7ea0de3b6b60cc0b8df8414f7ba3410f718475988649b7ea51a4f30221fdd9184d8acdf1c2af875add72cd9a8bfe84377dceb998225a9e738d0fd80187ecc57d8c95989a0bf28dbb177488fddb971fe473cd12e03687a8ce2687fa75fd502440b8306565bf4e572fc92e184caa34c81e79e2fa9fb8b02387d919871e84fc6bda115c81ef13290cc44f09eb6757d10f60abcbed'));

  console.log('\tRES', isValid);

  assert(isValid, 'ERROR: Unable to verify signature');
}

/**
 * @param {*} wasm
 */
export function dilithium2Benchmark (wasm) {
  const MESSAGE = stringToU8a('this is a message');

  for (let i = 0; i < 256; i++) {
    const seed = crypto.randomBytes(32);
    const [ , , pk] = extractKeys(wasm.dilithium2KeypairFromSeed(seed));

    assert(wasm.dilithium2Verify(wasm.dilithium2Sign(pk, seed, MESSAGE), MESSAGE, pk), 'ERROR: Unable to verify signature');
  }
}